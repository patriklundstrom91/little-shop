{% extends "base.html" %}
{% load order_extras %}
{% block content %}
<div class="container py-4">
    {% if order %}
        <h2>Payment Successful</h2>
        <p>Thank you for your order! Your payment was successful.</p>
        <p>Order #: {{ order.id }}</p>
        <p>Customer: {{ order.full_name }} ({{ order.email }})</p>
        <p>An confirmation email will also be sent to your email. Have a lovely day!</p>
        <hr>
        <h3>Your Items:</h3>
        <ul>
        {% for item in order.items.all %}
            <li>{{ item.quantity }} x {{ item.variant.product.name }} at £{{ item.price }} each, total: £{{ item.total_price|floatformat:2 }}</li>
        {% empty %}
            <li>No items found. Please check email confirmation and contact us if any problems.</li>
        {% endfor %}
        </ul>
        <p>Delivery cost: £{{ order.delivery_cost }}</p>
        {% if order.discount %}<p>Discount: £{{ order.discount|floatformat:2 }}</p>{% endif %}
        <p>Total: £{{ order.grand_total|floatformat:2 }}</p>
        <div class="mt-4">
            <a href="{% url 'home' %}" class="btn btn-primary me-2">Back to Home</a>
        </div>
    {% else %}
    <div class="alert alert-info">
        <strong>Your order is being processed...</strong><br>
        If this message doesn't disappear in a few seconds, please refresh the page and check your email.
    </div>
    {% endif %}
</div>
{% endblock %}
